
工会二期


数据库：

url: jdbc:oracle:thin:@8.131.228.8:1521:ORCL
username: PMR
password: PMR123456
driver-class-name: oracle.jdbc.OracleDriver


redis：
Redis-server

git init   # 把项目初始化,相当于在项目的跟目录生成一个 .git 目录
git add .    # 把项目的所有文件加入暂存区
git commit -am '项目初始化'     # 把项目提交到本地仓库，引号里面的是这次提交的注释，方便以后查看。
git remote rm origin  # 先删除远程 Git 仓库
git remote add origin https://github.com/BobinYang/   #为本地的仓库创建一个远程仓库. 例如：git remote add origin https://github.com/BobinYang/HtmlAgilityPackSample.git
git pull --rebase origin master  # 把远端仓库中的代码 拉到本地进得合并一下。
强制push本地仓库到远程 (这种情况不会进行merge, 强制push后远程文件可能会丢失 不建议使用此方法)
$ git push -u origin master -f
注意： 不能单纯地使用 git pull，也不能用 git push,这样作为报错的 
rebase操作不会生成新的节点，是将两个分支融合成一个线性的提交。https://www.cnblogs.com/chenyablog/p/10308058.html) 
执行后可以看到本地代码中多了README.md文件
git push origin master  # 将本地缓存仓库的文件推送到远程。master这个是分支名


git：
后端：
前端：
https://codeup.aliyun.com/qr/GH_YQ_FONT.git



git reset HEAD <file>... 来取消暂存

stackoverflow

goole

bugs

：
18.制度管理：修订时间，承办人，上传文件为必填；备注为选填去掉*；上传附件后新增和编辑其他信息时，附件仍然存在。
19.所有表单上方的筛选条件 按照一期的系统做；表单号 园区 所属年度（如果有） 时间区间；参照宣传教育-人才库；
20.所有表单的导出如果有子表信息的每次只能导出一条，按照表单格式导出；参照宣传教育-课堂讲师的导出。
21.任期管理：附件上传和备注为选填 *去掉；届期应关联数据字典，不是单纯的输入数字；人物信息卡片中 年资  没有按照入厂日期进行计算；附件上传问题；
22.来访记录管理：表单号标题有问题；申请日期为必填；来访主旨，来访性质，接待地点为选填；来访记录和附件上载为选填 *去掉；来访明细的 姓名 性别（没有选项） 单位 职务 为必填；接待明细的 姓名 工号 部门 分机为必填；附件和图片上传后新增和编辑其他信息时，附件仍然存在。
23.荣誉奖项：申请日期为当天日期没有自动带出且不可修改；申请人和申请人工号默认为当前管理员信息；所属年度，下发日期，所属日期为必填项；备注说明，关联文档，附件上载为选填*去掉；奖项类别，级别，所属年度，归档等级，机能类别，评选类别需关联数据字典做成手动选择。
24.表单样式问题参考非凡做的模块样式





导出excel内容：
前端：


exportXls() {
                if (this.selectedRowKeys.length == 0) {
                    this.$message.warning(this.$t('common.warn0'))
                    return;
                } else if (this.selectedRowKeys.length > 1) {
                    this.$message.warning(this.$t('common.warn1'))
                    return;
                } else {
                    this.handleExportXls(this.$t('act.new'));
                }
            },




  2.           exportXlsUrl: 'xxx/xxx/exportDetail',


    3.            <a-button type="primary" icon="download" @click="exportXls('任期管理')">



后端：
xxx.exp:
1add:   	private Integer index;
2edit:      	@Excel(name = "job", width = 15)   改英文


controller：



 	 @Autowired
	 private ITermusersService termusersService;

	 @Autowired
	 private IGhSysParkService ghSysParkService;

	 @Autowired
	 private ISysDictService sysDictService;





@GetMapping(value = "/exportDetail")
	 public ModelAndView exportDetail(String selections) {
		 Map<String, Object> map = new HashMap<String, Object>();
		 Map<String, Object> budgetMap = new HashMap<String, Object>();
		 List<Map<String, Object>> listMap = new ArrayList<Map<String, Object>>();
		 List<Map<String, Object>> fileMap = new ArrayList<Map<String, Object>>();
		 List<Map<String, Object>> userMap = new ArrayList<Map<String, Object>>();

		 //字典翻译园区
		 Map<String, String> parkMap = new HashMap<String, String>();
		 List<GhSysPark> parkList = ghSysParkService.list();
		 for (GhSysPark record : parkList) {
			 parkMap.put(record.getParkCode(), record.getParkName());
		 }
		 List<String> idList = Arrays.asList(selections.split(","));
		 QueryWrapper<Termmaagement> qw = new QueryWrapper<Termmaagement>();
		 qw.in("id", idList);
		 Termmaagement termmaagement= termmaagementService.getOne(qw);
		 termmaagement.setGhid(parkMap.get(termmaagement.getGhid()));
		 Map<String, Object> settlementMap = JSONObject.parseObject(JSON.toJSONString(termmaagement));

		 QueryWrapper<Termusers> queryWrapper = new QueryWrapper<Termusers>();
		 queryWrapper.in("mainid", idList);
		 queryWrapper.orderByAsc("id");
		 List<Termusers> dList = termusersService.list(queryWrapper);


		 Map<String, String> dept = getDict(new HashMap<String, String>(), "org_code");
		 Map<String, String> sex = getDict(new HashMap<String, String>(), "sex");


		 int num = 1;
		 if (dList != null && !dList.isEmpty()) {
			 for (Termusers record : dList) {
				 Termusers_exp bs = new Termusers_exp();
				 BeanUtils.copyProperties(record, bs);
				 bs.setIndex(num);
				 bs.setSex(sex.get(record.getSex()==null? "":record.getSex().toString()));
//				 bs.setDept(dept.get(record.getDept()));
				 num = num + 1;
				 Map<String, Object> lm = JSONObject.parseObject(JSON.toJSONString(bs));
				 listMap.add(lm);
			 }
		 }

		 map.put("settlementMap", settlementMap);
		 map.put("listMap", listMap);

		 ModelAndView mv = new ModelAndView(new JeecgTemplateExcelView());
		 ClassPathResource classPathResource = new ClassPathResource("exceltemplates/termmagement.xlsx");
		 String tempPath = classPathResource.getPath();
		 TemplateExportParams params = new TemplateExportParams(tempPath);

		 mv.addObject(TemplateExcelConstants.FILE_NAME, "任期管理工会职位明细");
		 mv.addObject(TemplateExcelConstants.PARAMS, params);
		 mv.addObject(TemplateExcelConstants.MAP_DATA, map);
		 return mv;
	 }



 public Map<String, String> getDict(Map<String, String> map, String dictCode) {
		 List<DictModel> list = sysDictService.queryDictItemsByCode(dictCode);
		 for (DictModel record : list) {
			 map.put(record.getValue(), record.getText());
		 }
		 return map;
	 }

excel模板：



已修改： termmanagemengt,regulation,
前：


问题：

VisiterreceptionList  申请日期